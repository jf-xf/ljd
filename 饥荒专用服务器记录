购买好服务器后，安装系统（我是安装的Ubuntu 20.04 server），然后将密码重置。

然后使用ssh连接，可以使用服务器推荐的软件，也可以使用其他软件。

连接后，为了方便使用。先创建一个用户账号，尽量别用root用户进行操作。

```Bash
useradd -r -m -s /bin/bash  username　#创建用户
passwd username   #设置密码
```

接下来，给你创建的用户添加权限。

```Bash
sudo vim /etc/sudoers

```

添加以下内容

```Bash
username ALL=(ALL) ALL
```

![](https://img2022.cnblogs.com/blog/2487673/202202/2487673-20220207193942638-2103899399.png)

然后使用

```Bash
su username
```

进到你创建的用户账号



接下来我们准备安装，首先将32位依赖库安装一下

```Bash
sudo apt update
sudo apt-get -y install lib32gcc1 lib32stdc++6 libcurl4-gnutls-dev:i386

```

然后再创建一个steamcmd的文件夹，安装steamcmd

```Bash
mkdir ~/steamcmd  # 新建文件夹
cd ~/steamcmd  # 进入刚刚新建的文件夹 
wget http://media.steampowered.com/installer/steamcmd_linux.tar.gz  # 下载steamcmd的安装包
tar -xvzf steamcmd_linux.tar.gz  # 解压刚刚下载的安装包

```

在运行第三步"wget"命令时，出现报错“media.steampowered.com”超时。这是DNS的配置问题

```Bash
sudo nano /etc/resolv.conf

#添加以下命令
nameserver 8.8.8.8

```

分别按ctrl+x，y，回车键。进行保存退出。然后重新运行"wget"命令。



使用ls命令可以看到，有以下四个文件

![](https://secure2.wostatic.cn/static/9i2hsFfqdCe4comJhyKyEe/image.png?auth_key=1723195159-tBqWKkqGcAoR696rPDqEve-0-a48348d4036b8c94178bce575ad491f4)

直接运行sh脚本

```Bash
./steamcmd.sh
```

执行完成后会出现以下信息

![](https://secure2.wostatic.cn/static/d743bnfxku39GspBf9cXbq/image.png?auth_key=1723195159-rExBsyBB9ZW9xKJhHp5Gws-0-1f1664b6c92ca16761956f1c6d00fa0a)

接下来我们进行安装饥荒

```Bash
force_install_dir "/home/jf/dst/"  #路径记得替换成自己的

```

PS:这个指令的意思是强制steamcmd将游戏下载到"/home/jf/dst/"这个目录中，linux会自动创建名叫dst的文件夹。（注意，这个更改是暂时的，即您退出再进入steamcmd的话需要再次输入这个指令来更改游戏的安装目录。）

再输入下面的指令：

```Bash
login anonymous
```

这个指令的意思是“匿名登录steam”，相当于不登陆地打开了steam商店。输入后屏幕上应当会显示以下信息：

![](https://secure2.wostatic.cn/static/81DnYdrqG1miAcVHLjZNGT/image.png?auth_key=1723195159-dT3tcB14EhUQj4byyKjLWf-0-abb1e1749bbd3b4f22ef2fbbbb8ebaff)

接下来输入下面的指令：

```Bash
app_update 343050 validate
```

这个指令意思是安装编号为343050的游戏，这个编号是服务器版Don’t Starve Together的编号，在网站[https://steamdb.keylol.com/](https://steamdb.keylol.com/)可以搜索到。

等待它安装完成后，就可以输入exit指令退出steamcmd了。

```Bash
exit
```

然后查看一下是否有.klei这个文件夹（因为这个文件是隐藏的，直接用ls是查看不到的，所以得加-al）

```Bash
cd
ls -al
```

发现没有，那就自己创建一下

```Bash
mkdir .klei
cd ~/.klei/
mkdir DoNotStarveTogether
```



在电脑搜索框输入cmd，以管理员身份运行。接下来使用scp将存档上传到服务器

```Bash
scp -P 22 -r C:\Users\江风\Desktop\Cluster_1 jf@113.45.141.248:/home/jf/.klei/DoNotStarveTogether
```

scp命令格式为：

-P xx  指定端口号

-r  声明上传的是文件夹

C:\Users\xxx\xxx   要上传文件的路径

root@xxx.xxx.xxx.xxx:/xxx/xxx/xxx  （用户名@IP地址:/要放在那个路径）

PS:在执行SCP命令后可能会有以下提示

> Are you sure you want to continue connecting (yes/no/[fingerprint])?

输入yes，然后按回车即可。（是看不到输入的，注意别打错了）然后会要求你输入你输入你服务器root用户的密码。接下来就开始上传了。

接下来启动存档

```Bash
cd ~/dst/bin
./dontstarve_dedicated_server_nullrenderer -console -cluster "my_cluster"
# -cluster "my_cluster"双引号内改成你自己旧存档的文件夹名字，注意是英文双引号
# -console 表示打开控制台，即存档运行期间你可以在服务器里像在饥荒游戏里一样输入控制台指令
# -cluster "my_cluster"最好放在最后，否则容易将其他参数识别为存档名

```

添加并配置mods
获取mods的ID
在steam的创意工坊中找到所需的mod或者mod合集，并复制其网址链接，链接最后的数字即为mod/mod合集的id。
例如：Global Positions在创意工坊中的网址

```Bash
[https://steamcommunity.com/sharedfiles/filedetails/?id=378160973](https://steamcommunity.com/sharedfiles/filedetails/?id=378160973)
```

其中378160973就是我们需要的mod id。

在mods文件/home/steam/dst/mods/dedicated_server_mods_setup.lua中按照文件提示的格式d写入id

```Bash
sudo nano /home/steam/dst/mods/dedicated_server_mods_setup.lua


# 一般每个mod都要写入两句函数，格式如下：
# 其中第一句用来下载安装mod，第二句用来指定游戏启动时自动更新mod

ServerModSetup("此处填入mod id数字号码")
ServerModCollectionSetup("此处也填入mod id数字号码")

```

重启服务器，使其自动下载mods，检查是否正常





指定开地面和洞穴

```Bash
cd ~/dst/bin
./dontstarve_dedicated_server_nullrenderer -console -cluster "Cluster_1" -shard Master
./dontstarve_dedicated_server_nullrenderer -console -cluster "Cluster_1" -shard Caves

```





```Bash
c_shutdown()  # 关闭服务器
```

